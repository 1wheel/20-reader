<:Head>
	<title>Recent Article</title>
</:Head>

<div page='blog'>
	<div>
		{{#each posts as post, index}}
		<div class='article'>
			<div class='title' on:click='toggle(index)'>
				{{post.title}}
				{{index == expanded}}
			</div>
			<div rel='prefetch' href='/blog/{{post.slug}}'></div>

		</div>
		{{/each}}
	</div>
</div>

<style>
	.article {
		/*margin: 5px;*/
		padding: 5px;
		border-bottom: 1px solid #fff;

	}

	.title{
		background: #000;
		color: #fff;
		padding-bottom: 5px;
		padding-top: 5px;
		font-size: 16px;
		/*height: 1.5em;*/
		/*overflow: hidden;*/
	}
</style>

<script>
	// import Layout from '../_components/Layout.html';

	export default {
		components: {
			// Layout
		},

		preload({ params, query }) {
			return fetch(`/api/feed`).then(r => r.json()).then(posts => {
				posts.forEach(d => {
					d.expanded = 0
				})

				var expanded = null

				return {posts, expanded};
			});
		},

		methods: {
			toggle(index){
				var currentExpanded = this.get('expanded')
				var expanded = currentExpanded == index ? null : index
				this.set({expanded})
			}
		}
	};
</script>